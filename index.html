<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
  <title>Vynix Lingua â€“ Verify Users</title>

  <!-- Fonts & Icons (same as main app) -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Poppins:wght@500;600;700&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/icon?family=Material+Symbols+Rounded" rel="stylesheet"/>

  <style>
    :root {
      --primary-black: #000;
      --primary-white: #fff;
      --gray-light: #f5f5f5;
      --gray-mid: #9e9e9e;
      --verified-blue: #1DA1F2;
      --danger: #ff3b30;
      --header-height: 60px;
      --pill-radius: 25px;
    }
    *{box-sizing:border-box;margin:0;padding:0;-webkit-user-select:none;}
    body{
      font-family:'Inter',sans-serif;
      background:var(--gray-light);
      color:#000;
      height:100vh;
      display:flex;
      flex-direction:column;
    }
    .top-bar{
      height:var(--header-height);
      background:var(--primary-black);
      display:flex;
      align-items:center;
      padding:0 16px;
      color:var(--primary-white);
      font-family:'Poppins',sans-serif;
      font-weight:600;
      font-size:18px;
      gap:12px;
    }
    .top-bar .back-btn{
      color:var(--primary-white);
      font-size:28px;
      cursor:pointer;
    }
    .container{
      flex:1;
      overflow-y:auto;
      padding:16px;
    }
    .user-row{
      display:flex;
      align-items:center;
      gap:12px;
      padding:12px;
      background:var(--primary-white);
      border-radius:12px;
      margin-bottom:12px;
    }
    .user-avatar{
      width:48px;height:48px;border-radius:50%;
      background:var(--gray-light);
      display:flex;align-items:center;justify-content:center;
      font-weight:600;
    }
    .user-info{flex:1;min-width:0;}
    .user-name{
      font-weight:500;
      display:flex;align-items:center;gap:6px;
    }
    .user-email{font-size:14px;color:var(--gray-mid);}
    .toggle-btn{
      padding:8px 16px;border:none;border-radius:20px;
      font-weight:600;cursor:pointer;transition:.2s;
    }
    .toggle-btn.on{background:var(--verified-blue);color:#fff;}
    .toggle-btn.off{background:var(--gray-light);color:var(--primary-black);}
    .toggle-btn.on::before{content:'Verified';}
    .toggle-btn.off::before{content:'Verify';}

    /* bottom-sheet auth (copied from your main app) */
    .auth-overlay{
      position:fixed;inset:0;background:rgba(0,0,0,.5);
      display:none;align-items:flex-end;z-index:300;
    }
    .auth-overlay.open{display:flex;}
    .auth-box{
      background:var(--primary-white);width:100%;
      border-radius:24px 24px 0 0;padding:32px 24px;
      animation:slideUp .3s;
    }
    @media (min-width:768px){
      .auth-overlay{align-items:center;justify-content:center;}
      .auth-box{width:380px;border-radius:20px;}
    }
    .auth-title{font-family:'Poppins',sans-serif;font-size:24px;font-weight:600;text-align:center;margin-bottom:8px;}
    .auth-subtitle{text-align:center;color:var(--gray-mid);margin-bottom:24px;font-size:14px;}
    .auth-input{width:100%;padding:14px 16px;border:1px solid rgba(0,0,0,.1);border-radius:12px;margin-bottom:16px;font-size:16px;background:var(--gray-light);}
    .auth-btn{width:100%;padding:14px;background:var(--primary-black);color:#fff;border:none;border-radius:12px;font-size:16px;font-weight:600;cursor:pointer;margin-bottom:16px;}
    .auth-switch{text-align:center;font-size:14px;color:var(--gray-mid);}
    .auth-switch-btn{background:none;border:none;color:var(--primary-black);font-weight:600;cursor:pointer;}
    @keyframes slideUp{from{transform:translateY(100%)}to{transform:translateY(0)}}
  </style>
</head>
<body>
  <header class="top-bar">
    <span class="material-symbols-rounded back-btn" onclick="history.back()">arrow_back</span>
    Verify Users
  </header>

  <main class="container" id="userList"></main>

  <!-- ====== bottom-sheet auth ====== -->
  <div id="authOverlay" class="auth-overlay">
    <div class="auth-box">
      <h2 class="auth-title" id="authTitle">Welcome</h2>
      <p class="auth-subtitle" id="authSub">Sign in to continue</p>
      <input type="email"    id="authEmail"    class="auth-input" placeholder="Email"/>
      <input type="password" id="authPass"     class="auth-input" placeholder="Password"/>
      <button class="auth-btn" id="authBtn">Sign In</button>
      <div class="auth-switch">
        <span id="authQ">Don't have an account?</span>
        <button class="auth-switch-btn" id="authSwitchBtn">Sign Up</button>
      </div>
    </div>
  </div>

  <!-- Firebase -->
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js';
    import { getAuth, onAuthStateChanged, signInWithEmailAndPassword, createUserWithEmailAndPassword, updateProfile } from 'https://www.gstatic.com/firebasejs/10.14.1/firebase-auth.js';
    import { getDatabase, ref, onValue, update } from 'https://www.gstatic.com/firebasejs/10.14.1/firebase-database.js';

    const firebaseConfig = {
      apiKey: "AIzaSyBOyZ3As4GTuNvjemvPF_SpsC6m6vqtNhc",
      authDomain: "fire-b-a8878.firebaseapp.com",
      databaseURL: "https://fire-b-a8878.firebaseio.com",
      projectId: "fire-b-a8878",
      storageBucket: "fire-b-a8878.firebasestorage.app",
      messagingSenderId: "658673187627",
      appId: "1:658673187627:web:32699cbc33e85f4bafa36e",
      measurementId: "G-2505EVBRWX"
    };

    const app  = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db   = getDatabase(app);

    const authOverlay   = document.getElementById('authOverlay');
    const authTitle     = document.getElementById('authTitle');
    const authSub       = document.getElementById('authSub');
    const authEmail     = document.getElementById('authEmail');
    const authPass      = document.getElementById('authPass');
    const authBtn       = document.getElementById('authBtn');
    const authSwitchBtn = document.getElementById('authSwitchBtn');
    const authQ         = document.getElementById('authQ');

    let isSignUp = false;
    let currentUser = null;

    /* ---------- auth sheet ---------- */
    function toggleAuthSheet(open){
      authOverlay.classList.toggle('open',open);
      document.body.classList.toggle('sheet-open',open);
    }
    authSwitchBtn.onclick = () => {
      isSignUp = !isSignUp;
      authBtn.textContent = isSignUp ? 'Sign Up' : 'Sign In';
      authTitle.textContent = isSignUp ? 'Create Account' : 'Welcome';
      authSub.textContent   = isSignUp ? 'Join Vynix Lingua' : 'Sign in to continue';
      authQ.textContent     = isSignUp ? 'Already have an account?' : 'Don\'t have an account?';
      authSwitchBtn.textContent = isSignUp ? 'Sign In' : 'Sign Up';
    };
    authBtn.onclick = async () => {
      const email = authEmail.value.trim();
      const pass  = authPass.value;
      if (!email || !pass) return alert('Please fill all fields');
      try {
        let cred;
        if (isSignUp){
          cred = await createUserWithEmailAndPassword(auth,email,pass);
          await updateProfile(cred.user,{displayName:email.split('@')[0]});
          await update(ref(db,`users/${cred.user.uid}`),{
            displayName:cred.user.displayName||email.split('@')[0],
            email,username:email.split('@')[0],
            verified:false,online:true
          });
        } else {
          cred = await signInWithEmailAndPassword(auth,email,pass);
          await update(ref(db,`users/${cred.user.uid}`),{online:true});
        }
        toggleAuthSheet(false);
      } catch (e) { alert(e.message) }
    };

    /* ---------- users list ---------- */
    const svgBadge = `
      <svg class="verified-badge" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M22.5 12.5c0-1.58-.875-2.95-2.148-3.6.154-.435.238-.905.238-1.4 0-2.21-1.71-3.998-3.818-3.998-.47 0-.92.084-1.336.25C14.818 2.415 13.51 1.5 12 1.5s-2.816.917-3.437 2.25c-.415-.165-.866-.25-1.336-.25-2.11 0-3.818 1.79-3.818 4 0 .495.083.965.238 1.4-1.272.65-2.147 2.02-2.147 3.6 0 1.56.86 2.91 2.115 3.567-.146.432-.225.898-.225 1.383 0 2.21 1.71 4 3.818 4 .47 0 .92-.084 1.336-.25.62 1.333 1.926 2.25 3.437 2.25 1.512 0 2.818-.917 3.437-2.25.415.165.866.25 1.336.25 2.11 0 3.818-1.79 3.818-4 0-.485-.08-.95-.225-1.383 1.255-.657 2.115-2.007 2.115-3.567z" fill="#1DA1F2"/>
        <path d="M10.198 16.556l-3.812-3.812 1.415-1.415 2.397 2.397 5.613-5.613 1.414 1.414-7.027 7.03z" fill="#FFFFFF"/>
      </svg>`;

    function renderUsers(list){
      const box = document.getElementById('userList');
      if (!list.length){ box.innerHTML = '<p style="text-align:center;color:var(--gray-mid)">No users yet.</p>'; return; }
      box.innerHTML = list.map(u=>`
        <div class="user-row">
          <div class="user-avatar">${(u.displayName||'A').charAt(0).toUpperCase()}</div>
          <div class="user-info">
            <div class="user-name">
              ${u.displayName||'Anonymous'} ${u.verified?svgBadge:''}
            </div>
            <div class="user-email">${u.email||''}</div>
          </div>
          <button class="toggle-btn ${u.verified?'on':'off'}" data-uid="${u.uid}" data-state="${u.verified?'on':'off'}"></button>
        </div>`).join('');

      document.querySelectorAll('.toggle-btn').forEach(btn=>{
        btn.onclick = async () => {
          const uid = btn.dataset.uid;
          const to  = btn.dataset.state === 'off';
          await update(ref(db,`users/${uid}`),{verified:to});
          btn.dataset.state = to?'on':'off';
          btn.classList.toggle('on',to); btn.classList.toggle('off',!to);
        };
      });
    }

    /* ---------- auth state ---------- */
    onAuthStateChanged(auth,user=>{
      if (!user){                    // show bottom-sheet
        toggleAuthSheet(true);
      } else {                      // load users
        currentUser = user;
        onValue(ref(db,'users'),snap=>{
          const list = []; snap.forEach(c=>list.push({uid:c.key,...c.val()})); renderUsers(list);
        });
      }
    });
  </script>
</body>
</html>
